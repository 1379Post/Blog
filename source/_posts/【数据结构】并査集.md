---
title: 【数据结构】并査集
categories: 主站
date: 2019-10-27 22:00:28
tags: 数据结构
---

 

# 并査集

**并査集**是一个用于维护**不相交集合（Disjoint Set)**的数据结构。其本质是对每一个元素选定一个“代表元”，且相同集合中元素的“代表元”相同（这个集合的“代表元”就是其中每个节点的代表元）。

注意：这个字读**chá**$!!!$

并査集可以用于维护具有**传递性**的信息，一个典型的例子是相等关系(若$a=b$，$b=c$,则$a=c$)（$ps$：恋爱关系很明显不具有传递性$\dots$)

---

## 结构

算法竞赛领域的“并査集”一般指**树形并查集**（并查集的实现还有一种链表形式，但效率非常低下，所以一般并不使用）

树形并查集的结构是一个**森林**，**每棵树代表一个集合**，其**树根**就是“代表元”，其结构如图所示：

![并查集演示.png](https://i.loli.net/2019/11/02/12t49VXGqTa85oL.png)

（图中1,2,3号节点构成一个代表元为1的集合，4号节点构成一个代表元为4的集合，5,6,7,8号节点构成一个代表元为5的集合）

由此可以看出，这种并查集的实现只要找到树根就可以判断两个元素是否在一个集合中，效率很高。

## 实现

### 找根

首先我们需要存储每个节点的父节点：

```cpp
int fa[maxn] //x的父节点为fa[x]
```

接下来，对于每个节点，我们只需要**沿着“父节点”不断向上寻找，直到找到父节点是自身的节点**（**树根**）

![找根.png](https://i.loli.net/2019/11/02/1w73FBHV2UMfvxS.png)

比如说对4号节点进行“找根”，因为4号节点的父节点是2号节点，再对2号节点进行“找根”，依此类推。直到找到1号节点，因为1号节点的父节点指向自身，因此可以判定1号节点是树根，即4号的“代表元”。